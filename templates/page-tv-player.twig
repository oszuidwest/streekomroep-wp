{% extends 'base.twig' %}

{% block head %}
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "VideoObject",
            "name": "{{ post.title }} - Live",
            "description": "{{ post.title }} - Live televisie{% if tv_today|length %} met vandaag {% for broadcast in tv_today %}{{ broadcast.name }}{% if loop.last %}{% elseif loop.revindex0 == 1 %} en {% else %}, {% endif %}{% endfor %}{% endif %}",
            {% if post.meta('tv_webplayer_poster') %}"thumbnailUrl": "{{ post.meta('tv_webplayer_poster') }}",{% endif %}
            {% if post.meta('tv_webplayer_hls_stream') %}"contentUrl": "{{ post.meta('tv_webplayer_hls_stream') }}",{% endif %}
            "embedUrl": "{{ post.link }}",
            "uploadDate": "{{ post.date('c') }}",
            "publication": {
                "@type": "BroadcastEvent",
                "isLiveBroadcast": true,
                "startDate": "{{ 'now'|date('Y-m-d') }}T00:00:00+01:00",
                "endDate": "{{ 'now'|date('Y-m-d') }}T23:59:59+01:00"
            }
        }
    </script>
{% endblock %}

{% block content %}
    <div class="bg-black text-white">
        <div class="w-full mx-auto lg:max-w-960 lg:pt-12 lg:mb-12">
            <div class="aspect-video">
                <div>
                    <video class="video-js vjs-fluid vjs-big-play-centered" autoplay controls playsinline
                        {% if post.meta('tv_webplayer_poster') %}poster="{{ post.meta('tv_webplayer_poster') }}"{% endif %}
                        {% if post.meta('tv_webplayer_hls_stream') %}data-vjs-src="{{ post.meta('tv_webplayer_hls_stream') }}" data-vjs-type="application/x-mpegURL" data-vjs-live{% endif %}>
                    </video>
                </div>
            </div>
            {% if tv_channels|length > 1 %}
                <nav class="flex justify-end bg-white/5 p-0.5 mt-1 rounded-sm gap-0.5">
                    {% for channel in tv_channels %}
                        {% if channel.id == post.id %}
                            <span class="px-3 py-1 rounded-sm bg-white/12 text-white text-xs font-bold flex items-center gap-1.5"><span class="size-1.5 rounded-full bg-blauw animate-pulse"></span>{{ channel.title }}</span>
                        {% else %}
                            <a href="{{ channel.link }}" class="px-3 py-1 rounded-sm bg-white/10 text-white/50 text-xs font-bold hover:bg-white/15 hover:text-white transition flex items-center gap-1.5"><span class="size-1.5 rounded-full bg-white/30"></span>{{ channel.title }}</a>
                        {% endif %}
                    {% endfor %}
                </nav>
            {% endif %}
        </div>

        <div class="mx-auto max-w-3xl px-4 lg:px-0 mt-6 pb-6">
            <h1 class="font-bold text-3xl">{{ post.title }} - Live</h1>
            <aside>
                <h2 class="mt-4 font-bold text-xl">Frequenties</h2>
                <ul>
                    {% for channel in post.meta('tv_frequenties') %}
                        <li>{{ channel.tv_frequenties_aanbieder }}: {{ channel.tv_frequenties_kanaal }}</li>
                    {% endfor %}
                </ul>
            </aside>
        </div>
    </div>
{% endblock %}
